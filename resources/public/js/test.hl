
(def defmacro
  (macro [sym args & body]
    (syntax-quote
      (def (unquote sym)
        (macro (unquote args)
          (unquote-splicing body))))))

(defmacro defn [sym args & body]
  (syntax-quote
    (def (unquote sym)
      (fn (unquote args)
        (unquote-splicing body)))))

(defmacro when [predicate & body]
  (syntax-quote
    (if (unquote predicate)
      (do (unquote-splicing body)))))

(defmacro when-not [predicate & body]
  (syntax-quote
    (if (unquote predicate)
      'nil
      (do (unquote-splicing body)))))

(defn make-radio [_]
  (receiverE 'nil))

(defn add-radio [radio, elem, val]
  (mapE
    (fn [v] (sendE radio val))
    (clicksE elem))
  (mapE
    (fn [v]
      (dom-dissoc! elem '"data-checked")
      (dom-remove-class! elem '"checked"))
    (filterE (fn [v] (not= v val)) radio))
  (mapE
    (fn [v]
      (dom-assoc! elem '"data-checked" '"data-checked")
      (dom-add-class! elem '"checked"))
    (filterE (fn [v] (= v val)) radio))
  (sendE radio val)
  elem)

(defn make-deck [_]
  (receiverE 'nil))

(defn add-deck [deck, elem, val]
  (mapE (fn [v] (dom-toggle! elem (= v val))) deck)
  elem)

(defn make-tabs [_]
  (make-radio 'nil))

(defn add-tab [tabs trig cont val]
  (let [t (add-radio tabs trig val)
        c (add-deck tabs cont val)]
    (values t c)))









